/workspace/miniconda/envs/vti/lib/python3.9/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]/workspace/miniconda/envs/vti/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.48s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.54s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.68s/it]
Obtaining direction

Loading visual direction from /workspace/VTI/runs/vti/d50t50/visual_direction.pt
visual_direction shape:  torch.Size([24, 577, 1024])
Adding visual direction to the model
Computing textual direction
Time taken: 24.502248764038086 seconds
Saving textual direction to /workspace/VTI/runs/vti/d50t50/textual_direction.pt
textual_direction shape:  torch.Size([32, 4096])
Adding textual direction to the model
Running MMHal benchmark

  0%|          | 0/96 [00:00<?, ?it/s]  1%|          | 1/96 [00:02<03:20,  2.11s/it]  2%|▏         | 2/96 [00:03<03:00,  1.92s/it]  3%|▎         | 3/96 [00:05<02:59,  1.93s/it]  4%|▍         | 4/96 [00:07<02:40,  1.75s/it]  5%|▌         | 5/96 [00:08<02:37,  1.73s/it]  6%|▋         | 6/96 [00:10<02:25,  1.62s/it]  7%|▋         | 7/96 [00:17<05:02,  3.40s/it]  8%|▊         | 8/96 [00:19<04:14,  2.89s/it]  9%|▉         | 9/96 [00:20<03:34,  2.47s/it] 10%|█         | 10/96 [00:22<03:15,  2.28s/it] 11%|█▏        | 11/96 [00:24<02:55,  2.07s/it] 12%|█▎        | 12/96 [00:25<02:40,  1.91s/it] 14%|█▎        | 13/96 [00:27<02:29,  1.80s/it] 15%|█▍        | 14/96 [00:28<02:20,  1.71s/it] 16%|█▌        | 15/96 [00:32<02:57,  2.20s/it] 17%|█▋        | 16/96 [00:33<02:38,  1.99s/it] 18%|█▊        | 17/96 [00:35<02:42,  2.06s/it] 19%|█▉        | 18/96 [00:37<02:25,  1.86s/it] 20%|█▉        | 19/96 [00:39<02:21,  1.84s/it] 21%|██        | 20/96 [00:40<02:11,  1.72s/it] 22%|██▏       | 21/96 [00:42<02:15,  1.81s/it] 23%|██▎       | 22/96 [00:44<02:15,  1.84s/it] 24%|██▍       | 23/96 [00:47<02:48,  2.31s/it] 25%|██▌       | 24/96 [00:49<02:32,  2.12s/it] 26%|██▌       | 25/96 [00:51<02:18,  1.95s/it] 27%|██▋       | 26/96 [00:52<02:11,  1.87s/it] 28%|██▊       | 27/96 [00:54<02:01,  1.76s/it] 29%|██▉       | 28/96 [00:56<02:00,  1.77s/it] 30%|███       | 29/96 [00:57<01:52,  1.68s/it] 31%|███▏      | 30/96 [01:00<02:08,  1.95s/it] 32%|███▏      | 31/96 [01:04<02:44,  2.54s/it] 33%|███▎      | 32/96 [01:05<02:23,  2.24s/it] 34%|███▍      | 33/96 [01:07<02:08,  2.04s/it] 35%|███▌      | 34/96 [01:08<02:01,  1.96s/it] 36%|███▋      | 35/96 [01:12<02:30,  2.47s/it] 38%|███▊      | 36/96 [01:14<02:11,  2.19s/it] 39%|███▊      | 37/96 [01:15<02:02,  2.08s/it] 40%|███▉      | 38/96 [01:17<01:59,  2.06s/it] 41%|████      | 39/96 [01:22<02:36,  2.74s/it] 42%|████▏     | 40/96 [01:24<02:17,  2.46s/it] 43%|████▎     | 41/96 [01:25<02:01,  2.21s/it] 44%|████▍     | 42/96 [01:28<02:00,  2.23s/it] 45%|████▍     | 43/96 [01:31<02:12,  2.51s/it] 46%|████▌     | 44/96 [01:32<01:51,  2.14s/it] 47%|████▋     | 45/96 [01:33<01:36,  1.90s/it] 48%|████▊     | 46/96 [01:35<01:32,  1.84s/it] 49%|████▉     | 47/96 [01:39<02:01,  2.49s/it] 50%|█████     | 48/96 [01:42<02:01,  2.54s/it] 51%|█████     | 49/96 [01:43<01:41,  2.16s/it] 52%|█████▏    | 50/96 [01:44<01:27,  1.91s/it] 53%|█████▎    | 51/96 [01:47<01:30,  2.02s/it] 54%|█████▍    | 52/96 [01:48<01:18,  1.78s/it] 55%|█████▌    | 53/96 [01:50<01:17,  1.80s/it] 56%|█████▋    | 54/96 [01:51<01:07,  1.61s/it] 57%|█████▋    | 55/96 [01:54<01:25,  2.07s/it] 58%|█████▊    | 56/96 [01:57<01:31,  2.28s/it] 59%|█████▉    | 57/96 [01:59<01:24,  2.16s/it] 60%|██████    | 58/96 [02:00<01:16,  2.00s/it] 61%|██████▏   | 59/96 [02:04<01:35,  2.57s/it] 62%|██████▎   | 60/96 [02:06<01:22,  2.28s/it] 64%|██████▎   | 61/96 [02:07<01:13,  2.11s/it] 65%|██████▍   | 62/96 [02:09<01:06,  1.94s/it] 66%|██████▌   | 63/96 [02:13<01:19,  2.42s/it] 67%|██████▋   | 64/96 [02:15<01:13,  2.31s/it] 68%|██████▊   | 65/96 [02:16<01:01,  2.00s/it] 69%|██████▉   | 66/96 [02:17<00:56,  1.89s/it] 70%|██████▉   | 67/96 [02:19<00:50,  1.75s/it] 71%|███████   | 68/96 [02:20<00:45,  1.62s/it] 72%|███████▏  | 69/96 [02:22<00:43,  1.62s/it] 73%|███████▎  | 70/96 [02:23<00:40,  1.55s/it] 74%|███████▍  | 71/96 [02:27<00:53,  2.13s/it] 75%|███████▌  | 72/96 [02:29<00:50,  2.10s/it] 76%|███████▌  | 73/96 [02:31<00:46,  2.02s/it] 77%|███████▋  | 74/96 [02:32<00:40,  1.83s/it] 78%|███████▊  | 75/96 [02:34<00:37,  1.79s/it] 79%|███████▉  | 76/96 [02:35<00:32,  1.60s/it] 80%|████████  | 77/96 [02:36<00:30,  1.60s/it] 81%|████████▏ | 78/96 [02:40<00:38,  2.12s/it] 82%|████████▏ | 79/96 [02:44<00:46,  2.75s/it] 83%|████████▎ | 80/96 [02:45<00:37,  2.36s/it] 84%|████████▍ | 81/96 [02:47<00:29,  1.99s/it] 85%|████████▌ | 82/96 [02:48<00:25,  1.81s/it] 86%|████████▋ | 83/96 [02:50<00:22,  1.76s/it] 88%|████████▊ | 84/96 [02:51<00:20,  1.73s/it] 89%|████████▊ | 85/96 [02:53<00:19,  1.73s/it] 90%|████████▉ | 86/96 [02:55<00:19,  1.97s/it] 91%|█████████ | 87/96 [03:00<00:25,  2.86s/it] 92%|█████████▏| 88/96 [03:02<00:19,  2.44s/it] 93%|█████████▎| 89/96 [03:03<00:15,  2.16s/it] 94%|█████████▍| 90/96 [03:05<00:11,  1.94s/it] 95%|█████████▍| 91/96 [03:06<00:09,  1.85s/it] 96%|█████████▌| 92/96 [03:08<00:06,  1.72s/it] 97%|█████████▋| 93/96 [03:10<00:05,  1.70s/it] 98%|█████████▊| 94/96 [03:11<00:03,  1.55s/it] 99%|█████████▉| 95/96 [03:14<00:02,  2.06s/it]100%|██████████| 96/96 [03:15<00:00,  1.86s/it]100%|██████████| 96/96 [03:15<00:00,  2.04s/it]
Finished evaluation, results saved to /workspace/VTI/runs/vti/d50t50/MMHal_answer.jsonl
