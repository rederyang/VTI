/workspace/miniconda/envs/vti/lib/python3.9/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]/workspace/miniconda/envs/vti/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Loading checkpoint shards:  50%|█████     | 1/2 [00:40<00:40, 40.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:51<00:00, 23.02s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:51<00:00, 25.59s/it]
Obtaining direction

> /workspace/VTI/experiments/eval/run_mmhal_vti.py(101)eval_model()
-> competitor_hook = CompetitorIntervention(args.competitor, **kwargs)
(Pdb) Registered clipping intervention on CLIPEncoderLayer
Running MMHal benchmark

  0%|          | 0/96 [00:00<?, ?it/s]Clipping 59392 entries out of 590848
  1%|          | 1/96 [00:05<08:27,  5.34s/it]Clipping 59392 entries out of 590848
  2%|▏         | 2/96 [00:07<05:18,  3.39s/it]Clipping 59392 entries out of 590848
  3%|▎         | 3/96 [00:09<04:09,  2.68s/it]Clipping 59392 entries out of 590848
  4%|▍         | 4/96 [00:10<03:27,  2.26s/it]Clipping 59392 entries out of 590848
  5%|▌         | 5/96 [00:12<03:14,  2.14s/it]Clipping 59392 entries out of 590848
  6%|▋         | 6/96 [00:14<03:04,  2.05s/it]Clipping 59392 entries out of 590848
  7%|▋         | 7/96 [00:24<06:49,  4.60s/it]Clipping 59392 entries out of 590848
  8%|▊         | 8/96 [00:26<05:24,  3.69s/it]Clipping 59392 entries out of 590848
  9%|▉         | 9/96 [00:27<04:20,  3.00s/it]Clipping 59392 entries out of 590848
 10%|█         | 10/96 [00:29<03:38,  2.55s/it]Clipping 59392 entries out of 590848
 11%|█▏        | 11/96 [00:30<03:11,  2.25s/it]Clipping 59392 entries out of 590848
 12%|█▎        | 12/96 [00:32<02:55,  2.09s/it]Clipping 59392 entries out of 590848
 14%|█▎        | 13/96 [00:34<02:39,  1.93s/it]Clipping 59392 entries out of 590848
 15%|█▍        | 14/96 [00:35<02:32,  1.86s/it]Clipping 59392 entries out of 590848
 16%|█▌        | 15/96 [00:42<04:33,  3.38s/it]Clipping 59391 entries out of 590848
 17%|█▋        | 16/96 [00:44<03:43,  2.80s/it]Clipping 59392 entries out of 590848
 18%|█▊        | 17/96 [00:46<03:25,  2.60s/it]Clipping 59392 entries out of 590848
 19%|█▉        | 18/96 [00:47<02:56,  2.26s/it]Clipping 59392 entries out of 590848
 20%|█▉        | 19/96 [00:49<02:42,  2.11s/it]Clipping 59392 entries out of 590848
 21%|██        | 20/96 [00:51<02:27,  1.94s/it]Clipping 59391 entries out of 590848
 22%|██▏       | 21/96 [00:53<02:36,  2.08s/it]Clipping 59392 entries out of 590848
 23%|██▎       | 22/96 [00:55<02:36,  2.12s/it]Clipping 59392 entries out of 590848
 24%|██▍       | 23/96 [01:05<05:15,  4.32s/it]Clipping 59392 entries out of 590848
 25%|██▌       | 24/96 [01:06<04:12,  3.51s/it]Clipping 59392 entries out of 590848
 26%|██▌       | 25/96 [01:08<03:27,  2.92s/it]Clipping 59392 entries out of 590848
 27%|██▋       | 26/96 [01:09<02:58,  2.55s/it]Clipping 59392 entries out of 590848
 28%|██▊       | 27/96 [01:11<02:29,  2.17s/it]Clipping 59392 entries out of 590848
 29%|██▉       | 28/96 [01:13<02:25,  2.14s/it]Clipping 59392 entries out of 590848
 30%|███       | 29/96 [01:14<02:13,  2.00s/it]Clipping 59392 entries out of 590848
 31%|███▏      | 30/96 [01:17<02:18,  2.10s/it]Clipping 59392 entries out of 590848
 32%|███▏      | 31/96 [01:25<04:17,  3.95s/it]Clipping 59392 entries out of 590848
 33%|███▎      | 32/96 [01:27<03:34,  3.36s/it]Clipping 59391 entries out of 590848
 34%|███▍      | 33/96 [01:29<03:00,  2.87s/it]Clipping 59392 entries out of 590848
 35%|███▌      | 34/96 [01:31<02:36,  2.53s/it]Clipping 59392 entries out of 590848
 36%|███▋      | 35/96 [01:37<03:39,  3.60s/it]Clipping 59392 entries out of 590848
 38%|███▊      | 36/96 [01:39<03:05,  3.10s/it]Clipping 59392 entries out of 590848
 39%|███▊      | 37/96 [01:40<02:40,  2.73s/it]Clipping 59392 entries out of 590848
 40%|███▉      | 38/96 [01:43<02:27,  2.54s/it]Clipping 59392 entries out of 590848
 41%|████      | 39/96 [01:51<04:04,  4.29s/it]Clipping 59392 entries out of 590848
 42%|████▏     | 40/96 [01:53<03:20,  3.58s/it]Clipping 59392 entries out of 590848
 43%|████▎     | 41/96 [01:54<02:44,  2.99s/it]Clipping 59392 entries out of 590848
 44%|████▍     | 42/96 [01:57<02:34,  2.85s/it]Clipping 59392 entries out of 590848
 45%|████▍     | 43/96 [02:01<02:55,  3.32s/it]Clipping 59392 entries out of 590848
 46%|████▌     | 44/96 [02:03<02:21,  2.72s/it]Clipping 59392 entries out of 590848
 47%|████▋     | 45/96 [02:04<01:57,  2.30s/it]Clipping 59392 entries out of 590848
 48%|████▊     | 46/96 [02:06<01:49,  2.18s/it]Clipping 59392 entries out of 590848
 49%|████▉     | 47/96 [02:12<02:38,  3.24s/it]Clipping 59392 entries out of 590848
 50%|█████     | 48/96 [02:13<02:10,  2.72s/it]Clipping 59392 entries out of 590848
 51%|█████     | 49/96 [02:14<01:48,  2.30s/it]Clipping 59392 entries out of 590848
 52%|█████▏    | 50/96 [02:16<01:35,  2.08s/it]Clipping 59392 entries out of 590848
 53%|█████▎    | 51/96 [02:22<02:28,  3.30s/it]Clipping 59392 entries out of 590848
 54%|█████▍    | 52/96 [02:23<01:57,  2.67s/it]Clipping 59392 entries out of 590848
 55%|█████▌    | 53/96 [02:25<01:44,  2.43s/it]Clipping 59392 entries out of 590848
 56%|█████▋    | 54/96 [02:26<01:25,  2.03s/it]Clipping 59392 entries out of 590848
 57%|█████▋    | 55/96 [02:34<02:36,  3.82s/it]Clipping 59392 entries out of 590848
 58%|█████▊    | 56/96 [02:38<02:26,  3.67s/it]Clipping 59392 entries out of 590848
 59%|█████▉    | 57/96 [02:40<02:04,  3.18s/it]Clipping 59392 entries out of 590848
 60%|██████    | 58/96 [02:41<01:43,  2.72s/it]Clipping 59392 entries out of 590848
 61%|██████▏   | 59/96 [02:48<02:20,  3.80s/it]Clipping 59392 entries out of 590848
 62%|██████▎   | 60/96 [02:49<01:49,  3.05s/it]Clipping 59392 entries out of 590848
 64%|██████▎   | 61/96 [02:52<01:42,  2.93s/it]Clipping 59392 entries out of 590848
 65%|██████▍   | 62/96 [02:53<01:26,  2.56s/it]Clipping 59392 entries out of 590848
 66%|██████▌   | 63/96 [02:59<01:56,  3.52s/it]Clipping 59392 entries out of 590848
 67%|██████▋   | 64/96 [03:01<01:38,  3.08s/it]Clipping 59391 entries out of 590848
 68%|██████▊   | 65/96 [03:02<01:18,  2.53s/it]Clipping 59392 entries out of 590848
 69%|██████▉   | 66/96 [03:05<01:13,  2.44s/it]Clipping 59392 entries out of 590848
 70%|██████▉   | 67/96 [03:06<01:03,  2.19s/it]Clipping 59392 entries out of 590848
 71%|███████   | 68/96 [03:08<00:55,  1.98s/it]Clipping 59392 entries out of 590848
 72%|███████▏  | 69/96 [03:09<00:51,  1.92s/it]Clipping 59392 entries out of 590848
 73%|███████▎  | 70/96 [03:11<00:47,  1.82s/it]Clipping 59392 entries out of 590848
 74%|███████▍  | 71/96 [03:17<01:15,  3.03s/it]Clipping 59392 entries out of 590848
 75%|███████▌  | 72/96 [03:18<01:02,  2.58s/it]Clipping 59392 entries out of 590848
 76%|███████▌  | 73/96 [03:20<00:54,  2.36s/it]Clipping 59392 entries out of 590848
 77%|███████▋  | 74/96 [03:22<00:45,  2.06s/it]Clipping 59392 entries out of 590848
 78%|███████▊  | 75/96 [03:23<00:40,  1.95s/it]Clipping 59392 entries out of 590848
 79%|███████▉  | 76/96 [03:25<00:36,  1.80s/it]Clipping 59392 entries out of 590848
 80%|████████  | 77/96 [03:26<00:32,  1.71s/it]Clipping 59392 entries out of 590848
 81%|████████▏ | 78/96 [03:29<00:33,  1.87s/it]Clipping 59392 entries out of 590848
 82%|████████▏ | 79/96 [03:36<00:59,  3.49s/it]Clipping 59392 entries out of 590848
 83%|████████▎ | 80/96 [03:38<00:47,  2.99s/it]Clipping 59392 entries out of 590848
 84%|████████▍ | 81/96 [03:39<00:36,  2.45s/it]Clipping 59392 entries out of 590848
 85%|████████▌ | 82/96 [03:40<00:30,  2.14s/it]Clipping 59392 entries out of 590848
 86%|████████▋ | 83/96 [03:42<00:25,  1.96s/it]Clipping 59392 entries out of 590848
 88%|████████▊ | 84/96 [03:43<00:22,  1.88s/it]Clipping 59392 entries out of 590848
 89%|████████▊ | 85/96 [03:45<00:20,  1.82s/it]Clipping 59392 entries out of 590848
 90%|████████▉ | 86/96 [03:47<00:18,  1.88s/it]Clipping 59392 entries out of 590848
 91%|█████████ | 87/96 [03:53<00:26,  2.97s/it]Clipping 59392 entries out of 590848
 92%|█████████▏| 88/96 [03:54<00:19,  2.49s/it]Clipping 59392 entries out of 590848
 93%|█████████▎| 89/96 [03:55<00:15,  2.15s/it]Clipping 59392 entries out of 590848
 94%|█████████▍| 90/96 [03:57<00:11,  1.98s/it]Clipping 59392 entries out of 590848
 95%|█████████▍| 91/96 [03:59<00:09,  1.95s/it]Clipping 59392 entries out of 590848
 96%|█████████▌| 92/96 [04:00<00:07,  1.78s/it]Clipping 59392 entries out of 590848
 97%|█████████▋| 93/96 [04:02<00:05,  1.74s/it]Clipping 59392 entries out of 590848
 98%|█████████▊| 94/96 [04:03<00:03,  1.61s/it]Clipping 59392 entries out of 590848
 99%|█████████▉| 95/96 [04:09<00:03,  3.01s/it]Clipping 59392 entries out of 590848
100%|██████████| 96/96 [04:11<00:00,  2.63s/it]100%|██████████| 96/96 [04:11<00:00,  2.62s/it]
Removed clipping intervention
Finished evaluation, results saved to /workspace/VTI/runs/clipping95_per-channel_post-last/MMHal_answer.jsonl
